<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>DNS Updater</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body{font-family:sans-serif;background:#f4f6f8;padding:20px}
    .card{max-width:720px;margin:30px auto;background:#fff;padding:20px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.1)}
    input{padding:10px;margin:6px 0;width:100%;border:1px solid #ccc;border-radius:6px}
    button{padding:10px 16px;border:none;border-radius:6px;background:#2d7cf3;color:#fff;cursor:pointer}
    .msg{margin-top:10px}
    table{margin-top:20px;width:100%;border-collapse:collapse}
    th,td{padding:8px;border:1px solid #ddd}
  </style>
</head>
<body>
<div class="card">
  <h2>DNS Updater</h2>
  <input id="subdomain" placeholder="Subdomain (misal: test1)">
  <input id="ip" placeholder="IP Address (misal: 103.196.146.28)">
  <button onclick="submitForm()">Add/Update</button>
  <div class="msg" id="msg"></div>
  <h3>Records</h3>
  <button onclick="loadList()">Refresh</button>
  <div id="list"></div>
</div>

<script>
async function submitForm(){
  const sub = document.getElementById('subdomain').value;
  const ip = document.getElementById('ip').value;
  document.getElementById('msg').textContent = 'Processing...';
  const r = await fetch('/api/dns', {
    method:'POST',headers:{'Content-Type':'application/json'},
    body:JSON.stringify({subdomain:sub,ip:ip})
  });
  const j = await r.json();
  if(j.ok){ document.getElementById('msg').textContent='Success âœ…'; loadList(); }
  else{ document.getElementById('msg').textContent='Error: '+j.message; }
}
async function loadList(){
  const r = await fetch('/api/list');
  const j = await r.json();
  if(!j.ok){ document.getElementById('list').textContent='Error'; return; }
  const rows=j.data.filter(rr=>rr.type==='A').map(rr=>`<tr><td>${rr.name}</td><td>${rr.rrdatas}</td><td>${rr.ttl}</td></tr>`).join('');
  document.getElementById('list').innerHTML=`<table><tr><th>Name</th><th>IP</th><th>TTL</th></tr>${rows}</table>`;
}
window.onload=loadList;
</script>
</body>
</html>
